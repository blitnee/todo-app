<!DOCTYPE html>
<html>
<head>
	<title>Todos Goals</title>
</head>
<body>
	<div>
		<h1>Todo List</h1>
		<input id='todo' type='text' placeholder='Add Todo' />
		<button id='todoBtn'>Add Todo</button>
		<ul id='todoList'></ul>
	</div>
	<div>
		<h1>Goal List</h1>
		<input id='goal' type='text' placeholder='Add Goal' />
		<button id='goalBtn'>Add Goals</button>
		<ul id='goalList'></ul>
	</div>

	<script type="text/javascript">
	/**
	 * LIBRARY CODE
	 */
		function createStore (reducer) {

			let state
			let listeners = []

			const getState = () => state

			const subscribe = (listener) => {
			 	listeners.push(listener)
			 	return () => {
			 		listeners = listeners.filter((l) => l !== listerner)
			 	}
			}

			const dispatch = (action) => {
		 		state = reducer(state, action)
		 		listeners.forEach((listener) => listener())
			}

			return {
			 	getState,
			 	subscribe,
			 	dispatch
			}
		}

	/**
	 * APP CODE
	 */
		}

		const ADD_TODO = 'ADD_TODO'
		const REMOVE_TODO = 'REMOVE_TODO'
		const TOGGLE_TODO = 'TOGGLE_TODO'
		const ADD_GOAL = 'ADD_GOAL'
		const REMOVE_GOAL = 'REMOVE_GOAL'

		function addTodoAction (todo) {
			return {
				type: ADD_TODO,
				todo,
			}
		}

		function removeTodoAction (id) {
			return {
				type: REMOVE_TODO,
				id,
			}
		}

		function toggleTodoAction (id) {
			return {
				type: TOGGLE_TODO,
				id,
			}
		}

		function addGoalAction (goal) {
			return {
				type: ADD_GOAL,
				goal,
			}
		}

		function removeGoalAction (id) {
			return {
				type: REMOVE_GOAL,
				id,
			}
		}

		function todos (state = [], action) {
			switch(action.type) {
				case ADD_TODO :
					return state.concat([action.todo])
				case REMOVE_TODO :
					return state.filter((todo) => todo.id !== action.id)
				case TOGGLE_TODO :
					return state.map((todo) => todo.id !== action.id ? todo :
					Object.assign({}, todo, { complete: !todo.complete }))
				default :
					return state
			}
		}

		function goals (state = [], action) {
			switch(action.type) {
				case ADD_GOAL :
					return state.concat([action.goal])
				case REMOVE_GOAL :
					return state.filter((goal) => goal.id !== action.id)
				default :
					return state
			}
		}

		function app (state = {}, action) {
			return {
				todos: todos(state.todos, action),
				goals: goals(state.goals, action),
			}
		}

		const store = createStore(app)

		store.subscribe(() => {
		})










	</script>

</body>
</html>